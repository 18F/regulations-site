define(["jquery","underscore","backbone","regs-state","regs-data","definition-view","sub-head-view","toc-view","regs-dispatch","sidebar-view"],function(e,t,n,r,i,s,o,u,a,f){return{getTree:function(t){var n=this;t.children().each(function(){var t=e(this),r=t.attr("id"),s=t.find("ol"),o;i.set({text:r,content:t.html()}),typeof (r,s)!="undefined"&&(o=s?e(s):t,n.getTree(o))})},bindEvents:function(){var n=function(t,n){e("#"+n).append(t)};e(".expand-button").on("click",function(t){var n=e(this);n.toggleClass("open").next(".hidden").slideToggle(),n.html(n.hasClass("open")?"Hide":"Show")}),e(".definition").on("click",function(n){n.preventDefault();if(e(this).data("active")){r.openDef.view.remove(),delete r.openDef.id,e(this).removeClass("active").removeData("active");return}var i=e(this).attr("data-definition"),o=e(n.target);o.addClass("active").data("active",1),t.isEmpty(r.openDef.link)||r.openDef.link.removeClass("active").removeData("active"),r.openDef.link=o;if(i===r.openDef.id)return;t.isEmpty(r.openDef.view)||r.openDef.view.remove(),r.openDef.id=i,r.openDef.view=new s({id:i,$anchor:o})}),e(".expand").on("click",function(t){t.preventDefault();var r=e(this).parent().attr("id"),s=i.retrieve(r);n(s,r),e(this).remove()}),e("#menu-link").on("click",function(t){return e("#table-of-contents, #reg-content, #menu-link, #content-header").toggleClass("active"),!1}),e(window).on("scroll",function(t){var n=e(this).scrollTop();n>=subhead.menuOffset?a.trigger("header:expand"):a.trigger("header:contract")})},init:function(){this.getTree(e("#reg-content")),window.subhead=new o({el:"#sub-head"}),window.toc=new u({el:"#menu"}),window.sidebar=new f({el:"#sidebar"}),this.bindEvents()}}});