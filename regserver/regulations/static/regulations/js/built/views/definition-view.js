define("definition-view",["jquery","underscore","backbone","sidebar-module-view","reg-model","dispatch","regs-helpers","./regs-router"],function(e,t,n,r,i,s,o,u){var a=r.extend({className:"open-definition",events:{"click .close-button.tab-activated":"close","click .close-button":"headerButtonClose","click .definition":"sendDefinitionLinkEvent","click .continue-link":"sendContinueLinkEvent"},formatInterpretations:function(){var t=this.$el.find(".inline-interpretation"),n;typeof t[0]!="undefined"&&(n=e(t[0]).data("interp-id"),t.remove(),this.$el.children(".definition-text").append(o.fastLink("#"+n,"Official Interpretation","continue-link internal interp")))},removeHeadings:function(){var t=this.$el.find("dfn.key-term"),n;if(typeof t[0]!="undefined"){n=t.length;for(var r=0;r<n;r++)e(t[r]).remove()}},definitionRouter:function(e,t){var n;e.indexOf("Interp")===-1?n=e.split("-").slice(0,2).join("-"):n=e.split("-")[0]+"-Interp",n===s.getOpenSection()?s.trigger("ga-event:definition",{action:t,context:"#"+e}):u.navigate(n+"/"+s.getVersion()+"#"+e,{trigger:!0})},sendContinueLinkEvent:function(t){t.preventDefault(),this.definitionRouter(e(t.target).attr("href").substr(1),"clicked continue link")},sendDefinitionLinkEvent:function(t){t.preventDefault(),this.definitionRouter(e(t.target).data("definition"),"clicked term inside definition")},render:function(){var e=i.get(this.model.id);return typeof e.done!="undefined"?e.done(function(e){this.template(e)}.bind(this)):this.template(e),this},template:function(e){var t;return this.$el.html('<div class="definition-text">'+e+"</div>"),t=this.$el.find(".definition-text"),this.$el.prepend('<div class="sidebar-header group"><h4>Defined Term<a class="right close-button" href="#">Close definition</a></h4></div>'),t.append(o.fastLink("#"+this.model.id,o.idToRef(this.model.id),"continue-link internal")),this.formatInterpretations(),this.removeHeadings(),this.$el.attr("tabindex","0"),t.append('<a class="close-button tab-activated" href="#">Close definition</a>'),s.trigger("definition:render",this.$el),this.$el.focus(),this},close:function(e){e.preventDefault(),s.remove("definition"),s.trigger("ga-event:definition",{action:"closed definition by tab-revealed link",context:this.model.id}),s.trigger("definition:remove",this.model.id)},headerButtonClose:function(e){e.preventDefault(),s.remove("definition"),s.trigger("ga-event:definition","close by header button"),s.trigger("definition:remove",this.model.id)},remove:function(){return this.stopListening(),this.$el.remove(),s.trigger("sidebarModule:remove",this.model.id),this}});return a});