define("main-view",["jquery","underscore","backbone","dispatch","search-results-view","reg-view","reg-model","search-model","sub-head-view"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({el:"#content-body",initialize:function(){this.header=new a,r.on("mainContent:change",this.render,this),r.on("regSection:open",this.loadContent,this),r.on("search:submitted",this.assembleSearchURL,this),r.on("loading:start",this.loading,this),r.on("loading:finish",this.loaded,this)},modelmap:{regSection:o,searchResults:u},viewmap:{regSection:s,searchResults:i},assembleSearchURL:function(e,t){var n=r.getRegId();n+="?q="+e.query,n+="&version="+e.version,typeof e.page!="undefined"&&(n+="&page="+e.page),e.url=n,this.loadContent(n,e,t)},loadContent:function(t,n,i){r.trigger("loading:start");var s=this.modelmap[i].get(t);typeof s.done!="undefined"?(s.done(function(e){this.createView(e,n,i)}.bind(this)),s.fail(function(){var t=document.createElement("div");t.innerHTML="There was an issue loading your data. This may be because your device is currently offline. Please try again.",t.className="alert",e(t).insertBefore("h2.section-number"),this.loaded()}.bind(this))):this.createView(s,n,i)},createView:function(e,t,n){r.removeContentView(),this.render(e,t.scrollToId),r.setContentView(new this.viewmap[n](t)),r.trigger("loading:finish")},render:function(t,n){var r,i;this.header.reset(),this.$el.html(t),typeof n!="undefined"&&(i=e("#"+n),i.length>0&&(r=i.offset().top)),window.scrollTo(0,r||0)},loading:function(){e(".main-content").addClass("loading")},loaded:function(){e(".main-content").removeClass("loading"),e(".section-focus").focus()}});return f});